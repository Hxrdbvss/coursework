{% extends "base.html" %}
{% block title %}
  Страница пользователя {{ profile.username }}
{% endblock %}
{% block content %}
  <h1 class="mb-5 text-center">Страница пользователя {{ profile.username }}</h1>
  <small>
    <ul class="list-group list-group-horizontal justify-content-center mb-3">
      <li class="list-group-item text-muted">Имя пользователя: {% if profile.get_full_name %}{{ profile.get_full_name }}{% else %}не указано{% endif %}</li>
      <li class="list-group-item text-muted">Регистрация: {{ profile.date_joined }}</li>
      <li class="list-group-item text-muted">Роль: {% if profile.is_staff %}Админ{% else %}Пользователь{% endif %}</li>
    </ul>
    <ul class="list-group list-group-horizontal justify-content-center">
      {% if user.is_authenticated and request.user == profile %}
      <a class="btn btn-sm text-muted" href="{% url 'password_change' %}">Изменить пароль</a>
      {% endif %}
    </ul>
  </small>
  <br>
  <h3 class="mb-5 text-center">Опросы, в которых участвовал пользователь</h3>
  {% for survey in surveys %}
    <article class="mb-5">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">{{ survey.title }}</h5>
          <a href="{% url 'polls:detail' survey.id %}" class="btn btn-primary">Просмотреть</a>
          <h6 class="mt-3">Ваши ответы:</h6>
          <ul class="list-group">
            {% for answer in user_answers %}
              {% if answer.question.survey == survey %}
                <li class="list-group-item">
                  <strong>{{ answer.question.text }}</strong>:
                  {% if answer.question.question_type == 'text' %}
                    {{ answer.text_answer|default:"Нет ответа" }}
                  {% elif answer.choice %}
                    {{ answer.choice.text }}
                  {% else %}
                    Нет ответа
                  {% endif %}
                </li>
              {% endif %}
            {% empty %}
              <li class="list-group-item">Ответов нет</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </article>
  {% empty %}
    <p class="text-center">Пользователь пока не участвовал в опросах.</p>
  {% endfor %}
{% endblock %}